/*! dom-to-image 16-09-2015 */
!function(a){"use strict";function b(a,b){for(var c=0;c<a.length;c++){var d=a[c];b.style.setProperty(d,a.getPropertyValue(d),a.getPropertyPriority(d))}}function c(a,c){a.cssText?c.style.cssText=a.cssText:b(a,c)}function d(b){var d=a.window.getComputedStyle(b.original);return c(d,b.clone),b}function e(a){return a.cssText+" content:"+a.getPropertyValue("content")+";"}function f(a){for(var b=[],c=a.length,d=0;c>d;d++){var e=a[d],f=e+": "+a.getPropertyValue(e);a.getPropertyPriority(e)&&(f+=" !important"),b.push(f)}return b.join(";")+";"}function g(b,c,d){var g="."+b+":"+c,h=d.cssText?e(d):f(d);return a.document.createTextNode(g+"{"+h+"}")}function h(b,c){var d=a.window.getComputedStyle(b.original,c),e=d.getPropertyValue("content");if(!e||"none"===e)return b;var f=z.next();b.clone.className=b.clone.className+" "+f;var h=a.document.createElement("style");return h.appendChild(g(f,c,d)),b.clone.appendChild(h),b}function i(a){return[":before",":after"].forEach(function(b){h(a,b)}),a}function j(a){return Promise.resolve(a).then(d).then(i)}function k(a){return a.clone instanceof SVGElement&&a.clone.setAttribute("xmlns","http://www.w3.org/2000/svg"),a}function l(a,b){return a instanceof Element?Promise.resolve({clone:a,original:b}).then(k).then(j).then(function(a){return a.clone}):a}function m(a,b,c){function d(b){g=g.then(function(){return n(b,c)}).then(function(b){b&&a.appendChild(b)})}var e=b.childNodes,f=e.length;if(0===f)return Promise.resolve(a);for(var g=Promise.resolve(),h=0;f>h;h++)d(e[h]);return g.then(function(){return a})}function n(a,b){return b&&!b(a)?Promise.resolve():Promise.resolve().then(function(){return a.cloneNode(!1)}).then(function(c){return m(c,a,b)}).then(function(b){return l(b,a)})}function o(a){var b=a.style;return b.margin=b.marginLeft=b.marginTop=b.marginBottom=b.marginRight="",a}function p(a){return a.replace(/#/g,"%23")}function q(a){return a.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),p((new XMLSerializer).serializeToString(a))}function r(a){return"<foreignObject x='0' y='0' width='100%' height='100%'>"+q(a)+"</foreignObject>"}function s(a,b,c){return"<svg xmlns='http://www.w3.org/2000/svg' width='"+b+"' height='"+c+"'>"+r(a)+"</svg>"}function t(a,b,c){return"data:image/svg+xml;charset=utf-8,"+s(a,b,c)}function u(a,b,c){return new Promise(function(d){var e=new Image;e.onload=function(){d(e)},e.src=t(o(a),b,c)})}function v(a,b){return w(a,b).then(function(b){var c=document.createElement("canvas");return c.width=a.scrollWidth,c.height=a.scrollHeight,c.getContext("2d").drawImage(b,0,0),c})}function w(a,b){return b=b||{},n(a,b.filter).then(function(b){return u(b,a.scrollWidth,a.scrollHeight)})}function x(a,b){return v(a,b).then(function(a){return a.toDataURL()})}function y(a,b){return v(a,b).then(function(a){return a.toBlob?new Promise(function(b){a.toBlob(b)}):function(a){for(var b=window.atob(a.toDataURL().split(",")[1]),c=new Uint8Array(b.length),d=0;d<b.length;d++)c[d]=b.charCodeAt(d);return new Blob([c],{type:"image/png"})}(a)})}var z=function(){function a(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}function b(){return"u"+a()+c++}var c=0;return{next:b}}(),A={load:function(a){var b=new XMLHttpRequest;return b.open("GET",a,!0),b.responseType="blob",new Promise(function(c,d){b.onload=function(){if(200!==this.status)return void d(new Error('Cannot fetch resource "'+a+'": '+this.status));var e=new FileReader;e.onloadend=function(){c(e.result.split(/,/)[1])},e.readAsDataURL(b.response)},b.send()})}},B=function(){function b(b,c){var d=a.document.implementation.createHTMLDocument(),e=d.createElement("base");d.head.appendChild(e);var f=d.createElement("a");return d.body.appendChild(f),e.href=c,f.href=b,f.href}function c(a,c){var d={},e=a.style.getPropertyValue("src");return e.split(/,\s*/).forEach(function(a){var e=/url\(['"]?([^\?"]+)\??.*?['"]?\)\s+format\(['"]?(.*?)['"]?\)/.exec(a);e&&(d[b(e[1],c)]=e[2])}),d}function d(a,b){if(a.type!==CSSRule.FONT_FACE_RULE)return null;var d=c(a,b);return 0===Object.keys(d).length?null:g({name:function(){return a.style.getPropertyValue("font-family").replace(/"/g,"")},urls:function(){return d},cssText:function(){return a.style.cssText}})}function e(){function a(a){c.push(new Promise(function(b){a.onload=b}))}for(var b=document.querySelectorAll("link[rel=stylesheet]"),c=[],d=0;d<b.length;d++)a(b[d]);return Promise.all(c)}function f(a){return e().then(function(){for(var b=a.styleSheets,c={},e=0;e<b.length;e++)for(var f=b[e].cssRules,g=0;g<f.length;g++){var h=d(f[g],b[e].href);h&&(c[h.data().name()]=h)}return{embedAll:function(a,b){var d=a.map(function(a){return c[a].embed(b||A)});return Promise.all(d).then(function(a){return a.join("\n")})},rules:function(){return c}}})}function g(a){function b(a){function b(a){return a.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}return new RegExp("url\\(['\"]?"+b(a)+"??.*?['\"]?\\)","g")}function c(a,b){return'url("data:font/'+a+";base64,"+b+'")'}function d(d){return new Promise(function(e,f){var g=a.cssText(),h=[],i=a.urls();Object.keys(i).forEach(function(a){h.push(d.load(a).then(function(d){g=g.replace(b(a),c(i[a],d))})["catch"](function(a){f(a)}))}),Promise.all(h).then(function(){e("@font-face {"+g+"}")})})}return{data:function(){return a},embed:d}}return{readAll:f,impl:{createRule:g,extractUrls:c}}}();a.domtoimage={toImage:w,toDataUrl:x,toBlob:y,impl:{webFontRule:B,util:{uid:z,resourceLoader:A}}}}(this);